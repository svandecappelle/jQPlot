!function(a){a.jqplot.MekkoAxisRenderer=function(){},a.jqplot.MekkoAxisRenderer.prototype.init=function(b){this.tickMode,this.barLabelRenderer=a.jqplot.AxisLabelRenderer,this.barLabels=this.barLabels||[],this.barLabelOptions={},this.tickOptions=a.extend(!0,{showGridline:!1},this.tickOptions),this._barLabels=[],a.extend(!0,this,b),"yaxis"==this.name&&(this.tickOptions.formatString=this.tickOptions.formatString||"%d%");var c=this._dataBounds;if(c.min=0,"yaxis"==this.name||"y2axis"==this.name)c.max=100,this.tickMode="even";else if("xaxis"==this.name){this.tickMode=null==this.tickMode?"bar":this.tickMode;for(var d=0;d<this._series.length;d++)c.max+=this._series[d]._sumy}else if("x2axis"==this.name){this.tickMode=null==this.tickMode?"even":this.tickMode;for(var d=0;d<this._series.length;d++)c.max+=this._series[d]._sumy}},a.jqplot.MekkoAxisRenderer.prototype.draw=function(b,c){if(this.show){this.renderer.createTicks.call(this);var d=document.createElement("div");this._elem=a(d),this._elem.addClass("jqplot-axis jqplot-"+this.name),this._elem.css("position","absolute"),d=null,"xaxis"==this.name||"x2axis"==this.name?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions),this._label.show&&this._elem.append(this._label.draw(b));var e,f,d;if(this.showTicks){e=this._ticks;for(var g=0;g<e.length;g++)f=e[g],!f.showLabel||f.isMinorTick&&!this.showMinorTicks||this._elem.append(f.draw(b))}for(g=0;g<this.barLabels.length;g++)if(this.barLabelOptions.axis=this.name,this.barLabelOptions.label=this.barLabels[g],this._barLabels.push(new this.barLabelRenderer(this.barLabelOptions)),"bar"!=this.tickMode&&(this._barLabels[g].show=!1),this._barLabels[g].show){var d=this._barLabels[g].draw(b,c);d.removeClass("jqplot-"+this.name+"-label"),d.addClass("jqplot-"+this.name+"-tick"),d.addClass("jqplot-mekko-barLabel"),d.appendTo(this._elem),d=null}}return this._elem},a.jqplot.MekkoAxisRenderer.prototype.reset=function(){this.min=this._min,this.max=this._max,this.tickInterval=this._tickInterval,this.numberTicks=this._numberTicks},a.jqplot.MekkoAxisRenderer.prototype.set=function(){var b,c=0,d=0,e=0,f=null==this._label?!1:this._label.show;if(this.show&&this.showTicks){for(var g=this._ticks,h=0;h<g.length;h++){var i=g[h];!i.showLabel||i.isMinorTick&&!this.showMinorTicks||(b="xaxis"==this.name||"x2axis"==this.name?i._elem.outerHeight(!0):i._elem.outerWidth(!0),b>c&&(c=b))}f&&(d=this._label._elem.outerWidth(!0),e=this._label._elem.outerHeight(!0)),"xaxis"==this.name?(c+=e,this._elem.css({height:c+"px",left:"0px",bottom:"0px"})):"x2axis"==this.name?(c+=e,this._elem.css({height:c+"px",left:"0px",top:"0px"})):"yaxis"==this.name?(c+=d,this._elem.css({width:c+"px",left:"0px",top:"0px"}),f&&this._label.constructor==a.jqplot.AxisLabelRenderer&&this._label._elem.css("width",d+"px")):(c+=d,this._elem.css({width:c+"px",right:"0px",top:"0px"}),f&&this._label.constructor==a.jqplot.AxisLabelRenderer&&this._label._elem.css("width",d+"px"))}},a.jqplot.MekkoAxisRenderer.prototype.createTicks=function(){var a,b,c,d,e,f,g=(this._ticks,this.ticks),h=this.name,i=this._dataBounds;if(g.length){for(f=0;f<g.length;f++){var j=g[f],d=new this.tickRenderer(this.tickOptions);j.constructor==Array?(d.value=j[0],d.label=j[1],this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(j[0],this.name),this._ticks.push(d)):(d.value=j,this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(j,this.name),this._ticks.push(d))}this.numberTicks=g.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{if(a="xaxis"==h||"x2axis"==h?this._plotDimensions.width:this._plotDimensions.height,null!=this.min&&null!=this.max&&null!=this.numberTicks&&(this.tickInterval=null),b=null!=this.min?this.min:i.min,c=null!=this.max?this.max:i.max,b==c){var k=.05;b>0&&(k=Math.max(Math.log(b)/Math.LN10,.05)),b-=k,c+=k}var l,m,n,o=c-b,p=[3,5,6,11,21];if("yaxis"==this.name||"y2axis"==this.name){if(this.min=0,this.max=100,this.numberTicks)this.tickInterval=o/(this.numberTicks-1);else if(this.tickInterval)this.numberTicks=3+Math.ceil(o/this.tickInterval);else{for(l=2+Math.ceil((a-(this.tickSpacing-1))/this.tickSpacing),f=0;f<p.length;f++){if(n=l/p[f],1==n){this.numberTicks=p[f];break}if(n>1)m=n;else{if(1>n){if(Math.abs(m-1)<Math.abs(n-1)){this.numberTicks=p[f-1];break}this.numberTicks=p[f];break}f==p.length-1&&(this.numberTicks=p[f])}}this.tickInterval=o/(this.numberTicks-1)}for(var f=0;f<this.numberTicks;f++)e=this.min+f*this.tickInterval,d=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(e,this.name),this._ticks.push(d)}else if("bar"==this.tickMode){for(this.min=0,this.numberTicks=this._series.length+1,d=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(0,this.name),this._ticks.push(d),l=0,f=1;f<this.numberTicks;f++)l+=this._series[f-1]._sumy,d=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(l,this.name),this._ticks.push(d);this.max=this.max||l,this.max>l&&(d=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(this.max,this.name),this._ticks.push(d))}else if("even"==this.tickMode){this.min=0,this.max=this.max||i.max;var q=2+Math.ceil((a-(this.tickSpacing-1))/this.tickSpacing);for(o=this.max-this.min,this.numberTicks=q,this.tickInterval=o/(this.numberTicks-1),f=0;f<this.numberTicks;f++)e=this.min+f*this.tickInterval,d=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(d.showMark=!1):(d.showLabel=!1,d.showMark=!1),d.setTick(e,this.name),this._ticks.push(d)}}},a.jqplot.MekkoAxisRenderer.prototype.pack=function(b,c){var d=this._ticks,e=this.max,f=this.min,g=c.max,h=c.min,i=null==this._label?!1:this._label.show;for(var j in b)this._elem.css(j,b[j]);this._offsets=c;var k=g-h,l=e-f;if(this.p2u=function(a){return(a-h)*l/k+f},this.u2p=function(a){return(a-f)*k/l+h},"xaxis"==this.name||"x2axis"==this.name?(this.series_u2p=function(a){return(a-f)*k/l},this.series_p2u=function(a){return a*l/k+f}):(this.series_u2p=function(a){return(a-e)*k/l},this.series_p2u=function(a){return a*l/k+e}),this.show)if("xaxis"==this.name||"x2axis"==this.name){for(var m=0;m<d.length;m++){var n=d[m];if(n.show&&n.showLabel){var o;if(n.constructor==a.jqplot.CanvasAxisTickRenderer&&n.angle){var p="xaxis"==this.name?1:-1;switch(n.labelPosition){case"auto":o=p*n.angle<0?-n.getWidth()+n._textRenderer.height*Math.sin(-n._textRenderer.angle)/2:-n._textRenderer.height*Math.sin(n._textRenderer.angle)/2;break;case"end":o=-n.getWidth()+n._textRenderer.height*Math.sin(-n._textRenderer.angle)/2;break;case"start":o=-n._textRenderer.height*Math.sin(n._textRenderer.angle)/2;break;case"middle":o=-n.getWidth()/2+n._textRenderer.height*Math.sin(-n._textRenderer.angle)/2;break;default:o=-n.getWidth()/2+n._textRenderer.height*Math.sin(-n._textRenderer.angle)/2}}else o=-n.getWidth()/2;var q=this.u2p(n.value)+o+"px";n._elem.css("left",q),n.pack()}}var r;i&&(r=this._label._elem.outerWidth(!0),this._label._elem.css("left",h+k/2-r/2+"px"),"xaxis"==this.name?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack());for(var s,t,u,m=0;m<this.barLabels.length;m++)s=this._barLabels[m],s.show&&(r=s.getWidth(),t=this._ticks[m].getLeft()+this._ticks[m].getWidth(),u=this._ticks[m+1].getLeft(),s._elem.css("left",(u+t-r)/2+"px"),s._elem.css("top",this._ticks[m]._elem.css("top")),s.pack())}else{for(var m=0;m<d.length;m++){var n=d[m];if(n.show&&n.showLabel){var o;if(n.constructor==a.jqplot.CanvasAxisTickRenderer&&n.angle){var p="yaxis"==this.name?1:-1;switch(n.labelPosition){case"auto":case"end":o=p*n.angle<0?-n._textRenderer.height*Math.cos(-n._textRenderer.angle)/2:-n.getHeight()+n._textRenderer.height*Math.cos(n._textRenderer.angle)/2;break;case"start":o=n.angle>0?-n._textRenderer.height*Math.cos(-n._textRenderer.angle)/2:-n.getHeight()+n._textRenderer.height*Math.cos(n._textRenderer.angle)/2;break;case"middle":o=-n.getHeight()/2;break;default:o=-n.getHeight()/2}}else o=-n.getHeight()/2;var q=this.u2p(n.value)+o+"px";n._elem.css("top",q),n.pack()}}if(i){var v=this._label._elem.outerHeight(!0);this._label._elem.css("top",g-k/2-v/2+"px"),"yaxis"==this.name?this._label._elem.css("left","0px"):this._label._elem.css("right","0px"),this._label.pack()}}}}(jQuery);